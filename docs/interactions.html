<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>6 Interactions | Analytical Paleobiology</title>
  <meta name="description" content="An informal course on analytical paleobiology">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="6 Interactions | Analytical Paleobiology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An informal course on analytical paleobiology" />
  <meta name="github-repo" content="psmits/paleo_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Interactions | Analytical Paleobiology" />
  <meta name="twitter:site" content="@PeterDSmits" />
  <meta name="twitter:description" content="An informal course on analytical paleobiology" />
  

<meta name="author" content="Peter D Smits">


<meta name="date" content="2019-04-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="reg-multi.html">
<link rel="next" href="logistic-regression.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="...">Short-Course on Analytical Paleobiology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="managing-and-processing-data-from-the-paleobiology-database.html"><a href="managing-and-processing-data-from-the-paleobiology-database.html"><i class="fa fa-check"></i><b>1</b> Managing and Processing Data From the Paleobiology Database</a><ul>
<li class="chapter" data-level="1.1" data-path="managing-and-processing-data-from-the-paleobiology-database.html"><a href="managing-and-processing-data-from-the-paleobiology-database.html#objectives"><i class="fa fa-check"></i><b>1.1</b> Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="managing-and-processing-data-from-the-paleobiology-database.html"><a href="managing-and-processing-data-from-the-paleobiology-database.html#project-reading"><i class="fa fa-check"></i><b>1.2</b> Reading</a></li>
<li class="chapter" data-level="1.3" data-path="managing-and-processing-data-from-the-paleobiology-database.html"><a href="managing-and-processing-data-from-the-paleobiology-database.html#introduction"><i class="fa fa-check"></i><b>1.3</b> Introduction</a></li>
<li class="chapter" data-level="1.4" data-path="managing-and-processing-data-from-the-paleobiology-database.html"><a href="managing-and-processing-data-from-the-paleobiology-database.html#getting-data"><i class="fa fa-check"></i><b>1.4</b> Getting data</a></li>
<li class="chapter" data-level="1.5" data-path="managing-and-processing-data-from-the-paleobiology-database.html"><a href="managing-and-processing-data-from-the-paleobiology-database.html#processing-data"><i class="fa fa-check"></i><b>1.5</b> Processing data</a></li>
<li class="chapter" data-level="1.6" data-path="managing-and-processing-data-from-the-paleobiology-database.html"><a href="managing-and-processing-data-from-the-paleobiology-database.html#binning-observations"><i class="fa fa-check"></i><b>1.6</b> Binning observations</a></li>
<li class="chapter" data-level="1.7" data-path="managing-and-processing-data-from-the-paleobiology-database.html"><a href="managing-and-processing-data-from-the-paleobiology-database.html#sharing-data"><i class="fa fa-check"></i><b>1.7</b> Sharing data</a></li>
<li class="chapter" data-level="1.8" data-path="managing-and-processing-data-from-the-paleobiology-database.html"><a href="managing-and-processing-data-from-the-paleobiology-database.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html"><i class="fa fa-check"></i><b>2</b> Introduction to Bayesian data analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#objectives-1"><i class="fa fa-check"></i><b>2.1</b> Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#reading"><i class="fa fa-check"></i><b>2.2</b> Reading</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#learning-from-data"><i class="fa fa-check"></i><b>2.3</b> Learning from data</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#counting-and-plausibility"><i class="fa fa-check"></i><b>2.3.1</b> Counting and plausibility</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#globe-example"><i class="fa fa-check"></i><b>2.4</b> Building a model</a><ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#a-data-story"><i class="fa fa-check"></i><b>2.4.1</b> A data story</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#bayes-updating-ex"><i class="fa fa-check"></i><b>2.4.2</b> Bayesian updating</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#evaluate"><i class="fa fa-check"></i><b>2.4.3</b> Evaluate</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#terms-and-theory"><i class="fa fa-check"></i><b>2.5</b> Terms and theory</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#bayes-theorem"><i class="fa fa-check"></i><b>2.6</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#but-how-does-it-work"><i class="fa fa-check"></i><b>2.7</b> But how does it <em>work</em>?</a><ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#grid-approximation"><i class="fa fa-check"></i><b>2.7.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>2.7.2</b> Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="2.7.3" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#aside-on-interpreting-probabilities"><i class="fa fa-check"></i><b>2.7.3</b> Aside on Interpreting Probabilities</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#working-with-samples"><i class="fa fa-check"></i><b>2.8</b> Working with samples</a><ul>
<li class="chapter" data-level="2.8.1" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#intervals-of-defined-boundaries"><i class="fa fa-check"></i><b>2.8.1</b> Intervals of defined boundaries</a></li>
<li class="chapter" data-level="2.8.2" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#intervals-of-defined-mass"><i class="fa fa-check"></i><b>2.8.2</b> Intervals of defined mass</a></li>
<li class="chapter" data-level="2.8.3" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#point-estimates"><i class="fa fa-check"></i><b>2.8.3</b> Point estimates</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-bayesian-data-analysis.html"><a href="introduction-to-bayesian-data-analysis.html#summary-1"><i class="fa fa-check"></i><b>2.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reg-intro.html"><a href="reg-intro.html"><i class="fa fa-check"></i><b>3</b> Introduction to linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="reg-intro.html"><a href="reg-intro.html#objectives-2"><i class="fa fa-check"></i><b>3.1</b> Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="reg-intro.html"><a href="reg-intro.html#reading-1"><i class="fa fa-check"></i><b>3.2</b> Reading</a></li>
<li class="chapter" data-level="3.3" data-path="reg-intro.html"><a href="reg-intro.html#linear-regression"><i class="fa fa-check"></i><b>3.3</b> Linear regression</a><ul>
<li class="chapter" data-level="3.3.1" data-path="reg-intro.html"><a href="reg-intro.html#talking-about-models"><i class="fa fa-check"></i><b>3.3.1</b> Talking about models</a></li>
<li class="chapter" data-level="3.3.2" data-path="reg-intro.html"><a href="reg-intro.html#growing-a-regression-model"><i class="fa fa-check"></i><b>3.3.2</b> Growing a regression model</a></li>
<li class="chapter" data-level="3.3.3" data-path="reg-intro.html"><a href="reg-intro.html#sampling-from-the-model"><i class="fa fa-check"></i><b>3.3.3</b> Sampling from the model</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="reg-intro.html"><a href="reg-intro.html#adding-a-predictor-to-the-mix"><i class="fa fa-check"></i><b>3.4</b> Adding a predictor to the mix</a><ul>
<li class="chapter" data-level="3.4.1" data-path="reg-intro.html"><a href="reg-intro.html#aside-dummy-coding"><i class="fa fa-check"></i><b>3.4.1</b> Aside: Dummy coding</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="reg-intro.html"><a href="reg-intro.html#interpreting-the-model-fit"><i class="fa fa-check"></i><b>3.5</b> Interpreting the model fit</a><ul>
<li class="chapter" data-level="3.5.1" data-path="reg-intro.html"><a href="reg-intro.html#linear-predictor"><i class="fa fa-check"></i><b>3.5.1</b> Linear predictor</a></li>
<li class="chapter" data-level="3.5.2" data-path="reg-intro.html"><a href="reg-intro.html#posterior-prediction"><i class="fa fa-check"></i><b>3.5.2</b> Posterior prediction</a></li>
<li class="chapter" data-level="3.5.3" data-path="reg-intro.html"><a href="reg-intro.html#posterior-predictive-tests"><i class="fa fa-check"></i><b>3.5.3</b> Posterior predictive tests</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="reg-intro.html"><a href="reg-intro.html#summary-2"><i class="fa fa-check"></i><b>3.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reg-continue.html"><a href="reg-continue.html"><i class="fa fa-check"></i><b>4</b> Continuing with regression with continuous predictors</a><ul>
<li class="chapter" data-level="4.1" data-path="reg-continue.html"><a href="reg-continue.html#objectives-3"><i class="fa fa-check"></i><b>4.1</b> Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="reg-continue.html"><a href="reg-continue.html#reading-2"><i class="fa fa-check"></i><b>4.2</b> Reading</a></li>
<li class="chapter" data-level="4.3" data-path="reg-continue.html"><a href="reg-continue.html#our-first-example"><i class="fa fa-check"></i><b>4.3</b> Our first example</a></li>
<li class="chapter" data-level="4.4" data-path="reg-continue.html"><a href="reg-continue.html#a-single-continuous-predictor"><i class="fa fa-check"></i><b>4.4</b> A single continuous predictor</a><ul>
<li class="chapter" data-level="4.4.1" data-path="reg-continue.html"><a href="reg-continue.html#centering"><i class="fa fa-check"></i><b>4.4.1</b> Aside: Centering</a></li>
<li class="chapter" data-level="4.4.2" data-path="reg-continue.html"><a href="reg-continue.html#continue-ppc"><i class="fa fa-check"></i><b>4.4.2</b> Checking model fit</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="reg-continue.html"><a href="reg-continue.html#summary-3"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reg-multi.html"><a href="reg-multi.html"><i class="fa fa-check"></i><b>5</b> Multiple predictors in linear regression</a><ul>
<li class="chapter" data-level="5.1" data-path="reg-multi.html"><a href="reg-multi.html#objectives-4"><i class="fa fa-check"></i><b>5.1</b> Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="reg-multi.html"><a href="reg-multi.html#reading-3"><i class="fa fa-check"></i><b>5.2</b> Reading</a></li>
<li class="chapter" data-level="5.3" data-path="reg-multi.html"><a href="reg-multi.html#more-than-one-predictor"><i class="fa fa-check"></i><b>5.3</b> More than one predictor</a><ul>
<li class="chapter" data-level="5.3.1" data-path="reg-multi.html"><a href="reg-multi.html#dummy"><i class="fa fa-check"></i><b>5.3.1</b> Categorical predictor</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="reg-multi.html"><a href="reg-multi.html#defining-our-model"><i class="fa fa-check"></i><b>5.4</b> Defining our model</a></li>
<li class="chapter" data-level="5.5" data-path="reg-multi.html"><a href="reg-multi.html#fitting-model-in-brms"><i class="fa fa-check"></i><b>5.5</b> Fitting model in <code>brms</code></a></li>
<li class="chapter" data-level="5.6" data-path="reg-multi.html"><a href="reg-multi.html#aside-standardizing"><i class="fa fa-check"></i><b>5.6</b> Aside: Standardizing</a></li>
<li class="chapter" data-level="5.7" data-path="reg-multi.html"><a href="reg-multi.html#multi-ppc"><i class="fa fa-check"></i><b>5.7</b> Checking model fit</a></li>
<li class="chapter" data-level="5.8" data-path="reg-multi.html"><a href="reg-multi.html#matrix-notation"><i class="fa fa-check"></i><b>5.8</b> Aside: Matrix Notation</a></li>
<li class="chapter" data-level="5.9" data-path="reg-multi.html"><a href="reg-multi.html#summary-4"><i class="fa fa-check"></i><b>5.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>6</b> Interactions</a><ul>
<li class="chapter" data-level="6.1" data-path="interactions.html"><a href="interactions.html#objectives-5"><i class="fa fa-check"></i><b>6.1</b> Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="interactions.html"><a href="interactions.html#reading-4"><i class="fa fa-check"></i><b>6.2</b> Reading</a></li>
<li class="chapter" data-level="6.3" data-path="interactions.html"><a href="interactions.html#introduction-1"><i class="fa fa-check"></i><b>6.3</b> Introduction</a></li>
<li class="chapter" data-level="6.4" data-path="interactions.html"><a href="interactions.html#inter-initial"><i class="fa fa-check"></i><b>6.4</b> Data and inital model</a></li>
<li class="chapter" data-level="6.5" data-path="interactions.html"><a href="interactions.html#how-to-specify-an-interaction"><i class="fa fa-check"></i><b>6.5</b> How to specify an interaction</a><ul>
<li class="chapter" data-level="6.5.1" data-path="interactions.html"><a href="interactions.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>6.5.1</b> Symmetry of interactions</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="interactions.html"><a href="interactions.html#fitting-a-model-with-an-interaction"><i class="fa fa-check"></i><b>6.6</b> Fitting a model with an interaction</a></li>
<li class="chapter" data-level="6.7" data-path="interactions.html"><a href="interactions.html#interpreting-our-model"><i class="fa fa-check"></i><b>6.7</b> Interpreting our model</a></li>
<li class="chapter" data-level="6.8" data-path="interactions.html"><a href="interactions.html#have-we-improved-on-our-previous-model"><i class="fa fa-check"></i><b>6.8</b> Have we improved on our previous model?</a></li>
<li class="chapter" data-level="6.9" data-path="interactions.html"><a href="interactions.html#continuouscontinuous-interactions"><i class="fa fa-check"></i><b>6.9</b> Continuous–Continuous interactions</a></li>
<li class="chapter" data-level="6.10" data-path="interactions.html"><a href="interactions.html#summary-5"><i class="fa fa-check"></i><b>6.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>7</b> Logistic regression</a><ul>
<li class="chapter" data-level="7.1" data-path="logistic-regression.html"><a href="logistic-regression.html#objectives-6"><i class="fa fa-check"></i><b>7.1</b> Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="logistic-regression.html"><a href="logistic-regression.html#reading-5"><i class="fa fa-check"></i><b>7.2</b> Reading</a></li>
<li class="chapter" data-level="7.3" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-2"><i class="fa fa-check"></i><b>7.3</b> Introduction</a></li>
<li class="chapter" data-level="7.4" data-path="logistic-regression.html"><a href="logistic-regression.html#foram-coiling"><i class="fa fa-check"></i><b>7.4</b> Foram coiling</a></li>
<li class="chapter" data-level="7.5" data-path="logistic-regression.html"><a href="logistic-regression.html#writing-out-a-model"><i class="fa fa-check"></i><b>7.5</b> Writing out a model</a><ul>
<li class="chapter" data-level="7.5.1" data-path="logistic-regression.html"><a href="logistic-regression.html#interpreting-logistic-regression-coefficients"><i class="fa fa-check"></i><b>7.5.1</b> Interpreting logistic regression coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="logistic-regression.html"><a href="logistic-regression.html#priors-for-our-model"><i class="fa fa-check"></i><b>7.6</b> Priors for our model</a></li>
<li class="chapter" data-level="7.7" data-path="logistic-regression.html"><a href="logistic-regression.html#fitting-our-model"><i class="fa fa-check"></i><b>7.7</b> Fitting our model</a></li>
<li class="chapter" data-level="7.8" data-path="logistic-regression.html"><a href="logistic-regression.html#checking-model-adequacy"><i class="fa fa-check"></i><b>7.8</b> Checking model adequacy</a></li>
<li class="chapter" data-level="7.9" data-path="logistic-regression.html"><a href="logistic-regression.html#summary-6"><i class="fa fa-check"></i><b>7.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="poisson-regression-and-others-glms.html"><a href="poisson-regression-and-others-glms.html"><i class="fa fa-check"></i><b>8</b> Poisson regression and others GLMs</a><ul>
<li class="chapter" data-level="8.1" data-path="poisson-regression-and-others-glms.html"><a href="poisson-regression-and-others-glms.html#outline"><i class="fa fa-check"></i><b>8.1</b> Outline</a></li>
<li class="chapter" data-level="8.2" data-path="poisson-regression-and-others-glms.html"><a href="poisson-regression-and-others-glms.html#poisson-distribution"><i class="fa fa-check"></i><b>8.2</b> Poisson distribution</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="varying-intercept-models.html"><a href="varying-intercept-models.html"><i class="fa fa-check"></i><b>9</b> Varying-intercept models</a><ul>
<li class="chapter" data-level="9.1" data-path="varying-intercept-models.html"><a href="varying-intercept-models.html#objectives-7"><i class="fa fa-check"></i><b>9.1</b> Objectives</a></li>
<li class="chapter" data-level="9.2" data-path="varying-intercept-models.html"><a href="varying-intercept-models.html#reading-6"><i class="fa fa-check"></i><b>9.2</b> Reading</a></li>
<li class="chapter" data-level="9.3" data-path="varying-intercept-models.html"><a href="varying-intercept-models.html#introduction-3"><i class="fa fa-check"></i><b>9.3</b> Introduction</a></li>
<li class="chapter" data-level="9.4" data-path="varying-intercept-models.html"><a href="varying-intercept-models.html#dummy-example"><i class="fa fa-check"></i><b>9.4</b> A basic model with categorical predictor</a></li>
<li class="chapter" data-level="9.5" data-path="varying-intercept-models.html"><a href="varying-intercept-models.html#notation-for-multilevel-models"><i class="fa fa-check"></i><b>9.5</b> Notation for multilevel models</a></li>
<li class="chapter" data-level="9.6" data-path="varying-intercept-models.html"><a href="varying-intercept-models.html#from-categorical-predictors-to-varying-intercept"><i class="fa fa-check"></i><b>9.6</b> From categorical predictors to varying-intercept</a></li>
<li class="chapter" data-level="9.7" data-path="varying-intercept-models.html"><a href="varying-intercept-models.html#fitting-a-multilevel-model"><i class="fa fa-check"></i><b>9.7</b> Fitting a multilevel model</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="varying-slopes-and-intercepts.html"><a href="varying-slopes-and-intercepts.html"><i class="fa fa-check"></i><b>10</b> Varying slopes and intercepts</a></li>
<li class="chapter" data-level="11" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>11</b> Model Comparison</a><ul>
<li class="chapter" data-level="11.1" data-path="model-comparison.html"><a href="model-comparison.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>11.1</b> Bias-Variance Trade-off</a><ul>
<li class="chapter" data-level="11.1.1" data-path="model-comparison.html"><a href="model-comparison.html#rmse"><i class="fa fa-check"></i><b>11.1.1</b> RMSE</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="model-comparison.html"><a href="model-comparison.html#regularization"><i class="fa fa-check"></i><b>11.2</b> Regularization</a></li>
<li class="chapter" data-level="11.3" data-path="model-comparison.html"><a href="model-comparison.html#information-criteria-and-waic"><i class="fa fa-check"></i><b>11.3</b> Information Criteria and WAIC</a></li>
<li class="chapter" data-level="11.4" data-path="model-comparison.html"><a href="model-comparison.html#looic"><i class="fa fa-check"></i><b>11.4</b> LOO(IC)</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>12</b> Time Series</a><ul>
<li class="chapter" data-level="12.1" data-path="time-series.html"><a href="time-series.html#objectives-8"><i class="fa fa-check"></i><b>12.1</b> Objectives</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">
Proudly published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analytical Paleobiology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactions" class="section level1">
<h1><span class="header-section-number">6</span> Interactions</h1>
<div id="objectives-5" class="section level2">
<h2><span class="header-section-number">6.1</span> Objectives</h2>
<ul>
<li>Introduce interaction terms for regression models</li>
<li>Demonstrate different “types” of interactions</li>
<li>Cover strategies for interpreting statistical interactions</li>
<li>Demonstrate ways of visualizing the effects of interaction terms</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pacman)

<span class="kw">p_load</span>(tidyverse, here, janitor, purrr, viridis, brms, tidybayes, bayesplot,
       modelr, forcats)

<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</code></pre></div>
</div>
<div id="reading-4" class="section level2">
<h2><span class="header-section-number">6.2</span> Reading</h2>
<ul>
<li>Chapter 7 “Interactions” from <a href="https://xcelab.net/rm/statistical-rethinking/"><strong>Statistical Rethinking</strong> by Richard McElreath</a>.</li>
<li>OPTIONAL Chapter 3 “Linear regression: the basics” from <a href="https://www.cambridge.org/core/books/data-analysis-using-regression-and-multilevelhierarchical-models/32A29531C7FD730C3A68951A17C9D983"><strong>Data Analysis Using Regression and Multilevel/Hierarchical Models</strong> by Gelman and Hill</a>.</li>
</ul>
</div>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">6.3</span> Introduction</h2>
<p>This lesson’s theme is “interaction effects – easy to compute, hard to explain.”</p>
<p><strong>Conditioning</strong> is an extremely important principle in statistics. Our data are conditional on how they get into our sample. Posterior distributions are conditional on the data. All model-based inference is conditional on the model. Every inference in conditional on something, whether we notice it or not.</p>
<p>The power of statistical modeling comes from the conditioning machines we construct that allow probability to be conditional of aspects of each case. Our linear regression models are crude robots that allow each outcome <span class="math inline">\(y_{i}\)</span> to be conditional on a set of predictors for each <span class="math inline">\(i\)</span>.</p>
<p>However, these linear models can fail to provide enough conditioning. Our previous models have assumed that each predictor has an independent association with the mean of the outcome. What if we want to allow the association to be conditional – that the association of one predictor with the mean of the outcome also depends on another predictor?</p>
<p>To model more complex conditionality, like the effect of one predictor which depends upon another predictor, we need what’s called an <strong>interaction</strong>. An interaction is a way to allow the posterior distributions of our parameters to be conditional on further aspects of the data. In practice, it is common for predictors with large effects also tend to have large interactions with other predictors (however, small effects do not preclude the possibility of large interactions). Including interactions is a way to allow a model to be fit differently to different subsets of the data.</p>
<p>Models with complex interactions are easy to fit to data, but they are considerably harder to understand. A linear interaction is the simplest kind of interaction and is built by extending the linear modeling strategy we’ve been following so far to parameters within the linear model itself. We’re going to be discussing these simple linear interactions in three contexts: specifying our model, interpreting our parameters, and visualizing them.</p>
</div>
<div id="inter-initial" class="section level2">
<h2><span class="header-section-number">6.4</span> Data and inital model</h2>
<p>This lesson continues are use of the PanTHERIA dataset. We’ve already built a multiple/multivariable regression model of population density as predicted by average species body mass and trophic level. While the <a href="reg-multi.html#multi-ppc">model from our previous lesson was an improvement</a> over <a href="reg-continue.html#continue-ppc">simpler models using only body mass</a> as an individual predictor of population density, there was still room for improvement – especially when describing variation among omnivorous species. In this exercise we’re going to cover specify how a linear interaction between body size and trophic level affects (mean) population density.</p>
<p>First, though, we need to import and clean up our data. We can also prepare our predictors by rescaling our continuous predictor body size and re-level trophic level at the same time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pantheria &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="kw">here</span>(<span class="st">&#39;data&#39;</span>, <span class="st">&#39;PanTHERIA_1-0_WR05_Aug2008.txt&#39;</span>), 
                      <span class="dt">na =</span> <span class="st">&#39;-999.00&#39;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mass_log =</span> <span class="kw">log</span>(x5_<span class="dv">1</span>_adult_body_mass_g),
         <span class="dt">range_group_log =</span> <span class="kw">log</span>(x22_<span class="dv">1</span>_home_range_km2),
         <span class="dt">range_indiv_log =</span> <span class="kw">log</span>(x22_<span class="dv">2</span>_home_range_indiv_km2),
         <span class="dt">density_log =</span> <span class="kw">log</span>(x21_<span class="dv">1</span>_population_density_n_km2),
         <span class="dt">activity_cycle =</span> <span class="kw">case_when</span>(x1_<span class="dv">1</span>_activity_cycle <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &#39;nocturnal&#39;</span>,
                                    x1_<span class="dv">1</span>_activity_cycle <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &#39;mixed&#39;</span>,
                                    x1_<span class="dv">1</span>_activity_cycle <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &#39;diurnal&#39;</span>),
         <span class="dt">trophic_level =</span> <span class="kw">case_when</span>(x6_<span class="dv">2</span>_trophic_level <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &#39;herbivore&#39;</span>,
                                   x6_<span class="dv">2</span>_trophic_level <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &#39;omnivore&#39;</span>,
                                   x6_<span class="dv">2</span>_trophic_level <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &#39;carnivore&#39;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">drop_na</span>(mass_log, density_log, trophic_level) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mass_stan =</span> arm<span class="op">::</span><span class="kw">rescale</span>(mass_log), <span class="co"># center and scale</span>
         <span class="dt">trophic_level =</span> <span class="kw">fct_infreq</span>(trophic_level)) <span class="co"># reorder by frequency</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   MSW05_Order = col_character(),
##   MSW05_Family = col_character(),
##   MSW05_Genus = col_character(),
##   MSW05_Species = col_character(),
##   MSW05_Binomial = col_character(),
##   References = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<p>Let’s also write out the model we developed in the last lesson so that we have a place to start. <span class="math display">\[
\begin{align}
y_{i} &amp;\sim \text{Normal}(\mu_{i}, \sigma) \\
\mu_{i} &amp;= \alpha + \beta_{m} m_{i} + \beta_{h} h_{i} + \beta_{c} c_{i} \\
\alpha &amp;\sim \text{Normal}(0, 10) \\
\beta_{m} &amp;\sim \text{Normal}(-1, 5) \\
\beta_{h} &amp;\sim \text{Normal}(0, 5) \\
\beta_{c} &amp;\sim \text{Normal}(0, 5) \\
\sigma &amp;\sim \text{Cauchy}^{+}(0, 5) \\
\end{align}
\]</span></p>
<p>And, of course, we can fit this model using <code>brm()</code> like we did in the last lesson. This initial model will provide a useful comparison with the new model we will develop in this lesson.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_<span class="dv">1</span> &lt;-<span class="st"> </span>
<span class="st">  </span>pantheria <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> .,
      <span class="dt">family =</span> <span class="kw">gaussian</span>(),
      <span class="dt">formula =</span> <span class="kw">bf</span>(density_log <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>mass_stan <span class="op">+</span><span class="st"> </span>trophic_level),
      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> Intercept),
                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="dt">class =</span> b),
                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>), <span class="dt">class =</span> b, <span class="dt">coef =</span> mass_stan),
                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="dt">class =</span> sigma)),
      <span class="dt">iter =</span> <span class="dv">2000</span>,
      <span class="dt">warmup =</span> <span class="dv">1000</span>,
      <span class="dt">chains =</span> <span class="dv">4</span>,
      <span class="dt">cores =</span> <span class="dv">4</span>,
      <span class="dt">refresh =</span> <span class="dv">0</span>)</code></pre></div>
</div>
<div id="how-to-specify-an-interaction" class="section level2">
<h2><span class="header-section-number">6.5</span> How to specify an interaction</h2>
<p>Specifying an interaction term is extremely easy. Let’s explore this using a very basic model where the mean of <span class="math inline">\(y\)</span> is predicted by two variables, one continuous <span class="math inline">\(c\)</span> and one binary <span class="math inline">\(b\)</span>. We can focus on the likelhood part of the model.</p>
<p><span class="math display">\[
\begin{align}
y &amp;\sim \text{Normal}(\mu_{i}, \sigma) \\
\mu_{i} &amp;= \alpha + \beta_{c} c_{i} + \beta_{b} b_{i} 
\end{align}
\]</span></p>
<p>In this case, we want to specify that the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(c\)</span> also depends on <span class="math inline">\(b\)</span>. The relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(c\)</span> is measured by the coefficient <span class="math inline">\(\beta_{c}\)</span>. Following the same strategy by which we replace parameters like <span class="math inline">\(\mu\)</span> with linear models, the most straightforward way to make <span class="math inline">\(\beta_{c}\)</span> depend on <span class="math inline">\(b\)</span> is to define the coefficient <span class="math inline">\(\beta_{c}\)</span> as a linear model itself with <span class="math inline">\(b\)</span> as a predictor!</p>
<p><span class="math display">\[
\begin{align}
y_{i} &amp;\sim \text{Normal}(\mu_{i}, \sigma) \\
\mu_{i} &amp;= \alpha + \gamma_{c} c_{i} + \beta_{b} b_{i} \\
\gamma_{i} &amp;= \beta_{c} + \beta_{cb} b_{i} \\
\end{align}
\]</span></p>
<p>While this is the first time we’ve written out a model with two linear models, its structure is still the same as all other linear regression models we’ve written. The issue is in how we interpret this model.</p>
<p>The first line of this model defines our Gaussian likelihood as normal. The second line defines the linear model of <span class="math inline">\(\mu\)</span> – again, something we’ve seen before. The linear function for <span class="math inline">\(\gamma\)</span> defines the interaction between <span class="math inline">\(y\)</span> and <span class="math inline">\(c\)</span>. This is a linear interaction effect because the equation <span class="math inline">\(\gamma\)</span> is a linear model.</p>
<p>By defining the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(c\)</span> this way, we are explicitly modeling the hypothesis that the slope between <span class="math inline">\(y\)</span> and <span class="math inline">\(c\)</span> is <strong>conditional</strong> on if <span class="math inline">\(b\)</span> is 1 or 0. The parameter <span class="math inline">\(\beta_{cb}\)</span> defines the strength of this dependency. If <span class="math inline">\(\beta_{cb}\)</span> is 0, then this model reduces to the non-interaction model. If <span class="math inline">\(\beta_{cb} &gt; 0\)</span> then observations with <span class="math inline">\(b = 1\)</span> have a greater slope between <span class="math inline">\(y\)</span> and <span class="math inline">\(c\)</span> than observations where <span class="math inline">\(b = 0\)</span>. Alternatively, if <span class="math inline">\(\beta_{cb} &lt; 0\)</span> then observations with <span class="math inline">\(b = 1\)</span> have a lower slope between <span class="math inline">\(y\)</span> and <span class="math inline">\(c\)</span> than observations where <span class="math inline">\(b = 0\)</span>. When <span class="math inline">\(b = 0\)</span>, this model again reduces to the interaction no longer affects <span class="math inline">\(\gamma\)</span>.</p>
<div id="symmetry-of-interactions" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Symmetry of interactions</h3>
<p>The way we’ve specified our linear interaction effect actually obscures something very important about how interactions work: they are symmetrical! By defining that the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(c\)</span> depends on <span class="math inline">\(b\)</span> also means that the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(b\)</span> also depends on <span class="math inline">\(c\)</span>. This fact becomes obvious with a little algebra. <span class="math display">\[
\begin{align}
\mu_{i} &amp;= \alpha + \gamma_{c} c_{i} + \beta_{b} b_{i} \\
\gamma_{i} &amp;= \beta_{c} + \beta_{cb} b_{i} \\
\mu_{i} &amp;= \alpha + (\beta_{c} + \beta_{cb} b_{i}) c_{i} + \beta_{b} b_{i} \\
&amp;= \alpha + \beta_{c} c_{i} + \beta_{cb} b_{i} c_{i} + \beta_{b} b_{i} \\
&amp;= \alpha + \beta_{c} c_{i} + (\beta_{b} + \beta_{cb} c_{i}) b_{i} \\
\end{align}
\]</span></p>
<p>Not only are interactions symmetrical, we could have defined <span class="math inline">\(\gamma\)</span> to be the slope of <span class="math inline">\(b\)</span> and a linear function of <span class="math inline">\(c\)</span>.</p>
<p>One of the intermediate steps of this little algebra exercise is actually the standard way of expressing an interaction between predictors: <span class="math display">\[
\begin{align}
y_{i} &amp;\sim \text{Normal}(\mu_{i}, \sigma) \\
\mu_{i} &amp;= \alpha + \beta_{c} c_{i} + \beta_{b} b_{i} + \beta_{cb} c_{i} b_{i}. \\
\end{align}
\]</span></p>
<p>This standard form is useful for two reasons:</p>
<ol style="list-style-type: decimal">
<li>it highlights the symmetry of the interaction,</li>
<li>this is how interactions are expressed in R.</li>
</ol>
<p>This symmetry is important because if either <span class="math inline">\(c\)</span> or <span class="math inline">\(b\)</span> change, this will affect of the other on mean <span class="math inline">\(y\)</span> also changes. In contrast to our previous linear models, we no longer can manipulate our predictors independently. This symmetry is the reason interaction effects can be difficult to interpret, especially from tables of parameter estimates. As we are going to do shortly, interpreting interactions almost always requires plotting out results.</p>
</div>
</div>
<div id="fitting-a-model-with-an-interaction" class="section level2">
<h2><span class="header-section-number">6.6</span> Fitting a model with an interaction</h2>
<p>We’ve spent a lot of time describing an interaction effect and how we can increase the conditionality of our parameters, but we’ve yet to actually look at parameter estimates or discuss how to actually interpret interaction effects.</p>
<p>Armed with what we’ve covered, we can quickly update our <a href="#inter_initial">initial model</a> by adding in the linear interaction between body mass and trophic level. Remember, while trophic level begins as a multi-state factor, it is translated via dummy coding into multiple binary predictors with one of the states acting as the model’s intercept and the regression coefficients describing the difference in mean <span class="math inline">\(y\)</span> between the default state and that predictors state. We’ve releveled trophic level so that the default state is omnivory and there are two binary predictors: herbivory and carnivory.</p>
<p><span class="math display">\[
\begin{align}
y_{i} &amp;\sim \text{Normal}(\mu_{i}, \sigma) \\
\mu_{i} &amp;= \beta_{0} + \beta_{m} m_{i} + \beta_{h} h_{i} + \beta_{c} c_{i} + \beta_{mh} m_{i} h_{i} + \beta_{mc} m_{i} c_{i} \\ 
&amp;= X_{i} \beta \\
\beta_{0} &amp;\sim \text{Normal}(0, 10) \\
\beta_{m} &amp;\sim \text{Normal}(-1, 5) \\
\beta_{h} &amp;\sim \text{Normal}(0, 5) \\
\beta_{c} &amp;\sim \text{Normal}(0, 5) \\
\beta_{mh} &amp;\sim \text{Normal}(0, 5) \\
\beta_{mc} &amp;\sim \text{Normal}(0, 5) \\
\sigma &amp;\sim \text{Cauchy}^{+}(0, 5) \\
\end{align}
\]</span></p>
<p>Luckily, there are some helpful R operators for specifying formulas. Interaction terms can be cleanly expressed in a few ways.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">density_log <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>mass_stan <span class="op">+</span><span class="st"> </span>trophic_level <span class="op">+</span><span class="st"> </span>mass_stan<span class="op">:</span>trophic_level

density_log <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>mass_stan <span class="op">*</span><span class="st"> </span>trophic_level</code></pre></div>
<p>In R formula syntax <code>:</code> represents the interaction between the relevant terms. While <code>*</code> also indicates an interaction, it also indicates the individual effects of the relevant forms because mass_stan * trophic_level expands to mass_stan + trophic_level + mass_stan:trophic_level. <code>*</code> is the compact way of indicating an interaction term.</p>
<p>Of course, you can also calculate the interaction between <code>mass_stan</code> and <code>trophic_level</code> by hand – it is multiplication after all. The hurdle here is that you’ll have to first do the dummy coding for <code>trophic_level</code> and then calculate the interaction for <code>mass_stan</code> and <code>trophic_levelheribivore</code> and the interaction with <code>trophic_levelcanivore</code>. I’ll leave this activity for interested parties who want to explore than on their own.</p>
<p>Now that we know how to specify an interaction using R formula syntax, we can implement and fit our model to the PanTHERIA dataset using <code>brm()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_<span class="dv">2</span> &lt;-<span class="st"> </span>
<span class="st">  </span>pantheria <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> .,
      <span class="dt">family =</span> <span class="kw">gaussian</span>(),
      <span class="dt">formula =</span> <span class="kw">bf</span>(density_log <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>mass_stan <span class="op">*</span><span class="st"> </span>trophic_level),
      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> Intercept),
                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="dt">class =</span> b),
                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>), <span class="dt">class =</span> b, <span class="dt">coef =</span> mass_stan),
                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="dt">class =</span> sigma)),
      <span class="dt">iter =</span> <span class="dv">2000</span>,
      <span class="dt">warmup =</span> <span class="dv">1000</span>,
      <span class="dt">chains =</span> <span class="dv">4</span>,
      <span class="dt">cores =</span> <span class="dv">4</span>,
      <span class="dt">refresh =</span> <span class="dv">0</span>)</code></pre></div>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(m_<span class="dv">2</span>)</code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: density_log ~ 1 + mass_stan * trophic_level 
##    Data: . (Number of observations: 746) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##                                  Estimate Est.Error l-95% CI u-95% CI
## Intercept                            3.20      0.11     3.00     3.40
## mass_stan                           -4.74      0.22    -5.15    -4.33
## trophic_levelherbivore               1.22      0.15     0.92     1.52
## trophic_levelcarnivore              -1.38      0.21    -1.79    -0.96
## mass_stan:trophic_levelherbivore    -0.14      0.30    -0.74     0.47
## mass_stan:trophic_levelcarnivore    -1.16      0.40    -1.95    -0.36
##                                  Eff.Sample Rhat
## Intercept                              3700 1.00
## mass_stan                              2433 1.00
## trophic_levelherbivore                 4107 1.00
## trophic_levelcarnivore                 4476 1.00
## mass_stan:trophic_levelherbivore       2870 1.00
## mass_stan:trophic_levelcarnivore       3461 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma     1.79      0.05     1.70     1.89       4825 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="interpreting-our-model" class="section level2">
<h2><span class="header-section-number">6.7</span> Interpreting our model</h2>
<p>But how do we interpret these parameters?</p>
<p><strong>Statistical Rethinking</strong> outlines two reasons why looking at a table of posterior estimates is a bad idea.</p>
<ol style="list-style-type: decimal">
<li>Adding an interaction to a model changes the meaning of the parameters. The “main effect” coefficient of the predictor in an interaction model no longer means the same thing as the variable with the same name in a model without an interaction. Their posterior distributions are not directly comparable.</li>
</ol>
<p>Interactions are tricky because this extra conditioning means that our normal interpretation of regression coefficients (expected change in <span class="math inline">\(y\)</span> per unit change in that predictor, holding all others constant) is no longer valid. If we manipulate the value of one predictor in an interaction, multiple parameters are involved and not that single coefficient.</p>
<ol start="2" style="list-style-type: decimal">
<li>Tables make it difficult to incorporate uncertainty into our thinking – we see a series individual numbers instead of the entire spread of numbers. This difficulty is exacerbated by the covariance between parameters being absent from our summary table, and when the effect of one predictor depends on multiple (2+) other predictors.</li>
</ol>
<p>Interpreting model with an interaction requires that we add/multiple multiple parameters together. Each of those parameters have posterior distributions. We aren’t adding mean estimates together, we’re combining multiple posterior distributions to yield our final posterior distribution of effects.</p>
<p>Recall our demo model: <span class="math display">\[
\begin{align}
y_{i} &amp;\sim \text{Normal}(\mu_{i}, \sigma) \\
\mu_{i} &amp;= \alpha + \gamma_{c} c_{i} + \beta_{b} b_{i} \\
\gamma_{i} &amp;= \beta_{c} + \beta_{cb} b_{i}. \\
\end{align}
\]</span> <span class="math inline">\(\gamma\)</span> depends on <span class="math inline">\(\beta_{c}\)</span> and <span class="math inline">\(\beta_{cb}\)</span>. Each of those parameters would have a posterior distribution. This means that <span class="math inline">\(\gamma\)</span> has a posterior distribution. When we look at a table of parameter estimates, it is hard to readily incorporate all of our uncertainty into our interpretations.</p>
<p>The easiest way around these difficulties is to plot our results and spend time visualizing the effect of the interaction on our estimates of <span class="math inline">\(y\)</span>. We can visualize change across multiple parameters while also including all of our uncertainty around those estimates.</p>
<p>So let’s do that. Let’s visualize how the effect of <code>mass_stan</code> varies by <code>trophic_level</code> (and vice-versa).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pantheria <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">data_grid</span>(<span class="dt">mass_stan =</span> <span class="kw">seq_range</span>(mass_stan, <span class="dt">n =</span> <span class="dv">1000</span>),
            trophic_level) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_predicted_draws</span>(<span class="dt">model =</span> m_<span class="dv">2</span>,
                      <span class="dt">n =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> mass_stan, <span class="dt">y =</span> .prediction, <span class="dt">fill =</span> trophic_level, <span class="dt">colour =</span> trophic_level)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_lineribbon</span>(<span class="kw">aes</span>(<span class="dt">group =</span> trophic_level), <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.9</span>), <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> pantheria,
             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> density_log), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Body mass (sd units)&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Population density&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="ot">NULL</span></code></pre></div>
<p><img src="paleo_book_files/figure-html/inter_vis-1.png" width="672" /></p>
<p>The slope of <code>mass_stan</code> on <code>density_log</code> for omnivores is different from the slopes for the other trophic levels! The interaction between <code>mass_stan</code> and <code>trophic_levelomnivore</code> on <code>density_log</code> manifests as a more negative slope when compared to the other <code>trophic_level</code> states. This can also be phrased as that relationship has a greater slope magnitude (higher absolute value).</p>
<p>Also, the slopes for herbivores and carnivores are almost identical. If we look at the table of parameter estimates from our model we’ll notice that the posterior for <code>mass_stan:tophic_levelherbivore</code> is centered near 0. As we noted earlier, when an interaction effect is close to 0, the model simplifies to the non-interactive case. There is however, a non-zero interaction between <code>mass_stan</code> and <code>trophic_levelomnivore</code>. The extent of this interaction is obvious from the plot we made. Without making a plot visualizing our model’s results, we are able to go back and actually understand what the table of parameter estimates actually means.</p>
</div>
<div id="have-we-improved-on-our-previous-model" class="section level2">
<h2><span class="header-section-number">6.8</span> Have we improved on our previous model?</h2>
<p>Now that we’ve fit our model and taken a quick look, we really should evaluate how well our model represents our data. Additionally, we might be curious if our interaction model is a better model of our data than the model without an interaction effect, and if so by how much.</p>
<p>We’ve already visualized our models predictions across the range of body sizes and trophic levels, so there is no need to plot that again. Let’s instead use the posterior predictive checks we’ve <a href="reg-multi.html#multi-ppc">before</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pantheria <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_predicted_draws</span>(<span class="dt">model =</span> m_<span class="dv">2</span>,
                      <span class="dt">n =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> .prediction, <span class="dt">group =</span> .draw)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">stat =</span> <span class="st">&#39;density&#39;</span>,
            <span class="dt">alpha =</span> <span class="fl">0.1</span>,
            <span class="dt">colour =</span> <span class="st">&#39;blue&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">stat =</span> <span class="st">&#39;density&#39;</span>,
            <span class="dt">data =</span> pantheria,
            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> density_log,
                          <span class="dt">group =</span> <span class="ot">NULL</span>),
            <span class="dt">colour =</span> <span class="st">&#39;black&#39;</span>,
            <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&#39;Population density &#39;</span>, <span class="kw">log</span>(n <span class="op">/</span><span class="st"> </span>km<span class="op">^</span><span class="dv">2</span>))),
       <span class="dt">title =</span> <span class="st">&#39;Population density, actual versus predicted&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>trophic_level) <span class="op">+</span>
<span class="st">  </span><span class="ot">NULL</span></code></pre></div>
<p><img src="paleo_book_files/figure-html/inter_dens_ppc-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pan_trophic_summary &lt;-
<span class="st">  </span>pantheria <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(trophic_level) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">median =</span> <span class="kw">median</span>(density_log),
                   <span class="dt">sd =</span> <span class="kw">sd</span>(density_log)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(key, value, median, sd)

pantheria_summary_ppc &lt;-<span class="st"> </span>
<span class="st">  </span>pantheria <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_predicted_draws</span>(<span class="dt">model =</span> m_<span class="dv">2</span>,
                      <span class="dt">n =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(.draw, trophic_level) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">median =</span> <span class="kw">median</span>(.prediction),
                   <span class="dt">sd =</span> <span class="kw">sd</span>(.prediction)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(key, value, median, sd)

pantheria_summary_ppc <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&#39;blue&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> pan_trophic_summary,
             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">xintercept =</span> value),
             <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(key <span class="op">~</span><span class="st"> </span>trophic_level, <span class="dt">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="dt">switch =</span> <span class="st">&#39;y&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Median population density&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="ot">NULL</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="paleo_book_files/figure-html/inter_median_ppc-1.png" width="672" /></p>
<p>Visual comparison of these posterior predictive check results to those from our earlier, non-interaction model indicates the possibility that our model is doing a better job at predicting population density values for omnivorous taxa than our previous model while maintaining the high quality of fit to the population densities of the herbivorous and carnivorous observations.</p>
<p>Visual comparisons can be sometimes unsatisfying when we’re trying to understand how much of an improvement this model is over the previous one. In another lessons we will cover ways compare the relative quality of fit of different models. For now, we are covering the “how-to” of developing, fitting, and understanding interaction models.</p>
</div>
<div id="continuouscontinuous-interactions" class="section level2">
<h2><span class="header-section-number">6.9</span> Continuous–Continuous interactions</h2>
<p>TODO</p>
</div>
<div id="summary-5" class="section level2">
<h2><span class="header-section-number">6.10</span> Summary</h2>
<p>In this lesson we covered “how-to” develop, fit, and interpret regression models with a linear interaction. The refrain from this lesson is that “interactions are easy to fit, but hard to interpret.” The concept and notation of interactions was first introduced in order to explain what exactly we’re talking about when we talk bout “interaction terms.” Next, following <strong>Statistical Rethinking</strong>, we emphasized understanding interactions through graphs and visualization instead of tables of parameter estimates. This involved developing and fitting a regression model of mammal population density that included an interaction between a continuous predictor and a multistate categorical predictor. This new model demonstrated a notable interaction between body size and omnivore that improved our models ability to represent our data when compared to a similar model without an interaction term.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reg-multi.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": [["analytical_paleobiology.pdf", "PDF"], ["analytical_paleobiology.epub", "EPUB"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
